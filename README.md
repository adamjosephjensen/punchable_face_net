# Punchable Face Net - Image Labeler

This tool provides a web interface to label images based on a subjective criterion (e.g., "annoying" vs. "not annoying"). It's designed to work with the CelebA dataset.

## Prerequisites

*   **Python 3:** Ensure Python 3 is installed.
*   **Flask:** The web application framework. Install using pip:
    ```bash
    pip install Flask
    ```
*   **CelebA Dataset:** You need the CelebA dataset downloaded and accessible on your system. Specifically:
    *   The attribute file: `list_attr_celeba.txt`
    *   The image directory: `img_align_celeba`
*   **Configuration:** Before running any scripts, verify the hardcoded paths within the Python files match your system:
    *   `generate_training_list.py`: Check `CELEBA_ATTRIBUTE_FILE`.
    *   `app/labeler.py`: Check `CELEBA_IMAGE_DIR`.

## Setup & Usage

### 1. Generate the Training Image List

This step selects a subset of images based on specific attributes (currently configured for "Male" = "1") and creates a list file used by the labeler.

*   **Script:** `generate_training_list.py`
*   **Configuration:**
    *   `CELEBA_ATTRIBUTE_FILE`: Path to your `list_attr_celeba.txt`.
    *   `OUTPUT_FILE`: `./data/training_imgs.txt` (where the list will be saved).
    *   `TARGET_ATTRIBUTE`: The CelebA attribute to filter by (e.g., "Male").
    *   `TARGET_VALUE`: The value for the target attribute (e.g., "1").
    *   `DEFAULT_NUM_IMAGES`: Default number of images to select.
*   **Run:** Execute the script from the project root directory. You can optionally specify the number of images:
    ```bash
    # Generate list with default number of images (1000)
    python generate_training_list.py

    # Generate list with a specific number of images (e.g., 500)
    python generate_training_list.py --num_images 500
    ```
*   **Output:** This creates `./data/training_imgs.txt` containing the filenames.

### 2. Run the Labeler Application

This starts a local web server to display images and record your labels.

*   **Script:** `app/labeler.py`
*   **Configuration:**
    *   `CELEBA_IMAGE_DIR`: Path to your CelebA `img_align_celeba` directory.
    *   `TRAINING_LIST_FILE`: Path to the generated list (`./data/training_imgs.txt`).
    *   `LABELS_FILE`: Path where labels will be saved (`./data/labels.csv`).
*   **Run:** Execute the script from the project root directory:
    ```bash
    python app/labeler.py
    ```
*   **Access:** Open your web browser and go to `http://127.0.0.1:5000` (or the address shown in the terminal, possibly using your machine's IP if accessing from another device on the network).
*   **Labeling:**
    *   Click "Annoying" or "Not Annoying" buttons.
    *   Use keyboard shortcuts: `H` (Annoying), `L` (Not Annoying), `S` (Skip).
    *   Labels are saved immediately upon clicking/keypress.

## Output

*   **`./data/training_imgs.txt`:** List of image filenames selected for labeling. Generated by `generate_training_list.py`.
*   **`./data/labels.csv`:** Stores the labels you provide. Each row contains a `filename` and its corresponding `label` (1 for annoying, 0 for not annoying). This file is created/updated by `app/labeler.py`.
